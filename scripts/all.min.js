function generate(){for(var t=0;3>t;++t){var r,e;if(randTree.root.addChild({name:t}),randTree.root.children()[t].addChild(),2*Math.random()>1&&randTree.root.children()[t].addChild(),2*Math.random()>1&&(r=randTree.root.children(),e=r.length,r[Math.floor(Math.random()*e)].addChild()),2*Math.random()>1){r=randTree.root.children(),e=r.length;var o=r[Math.floor(Math.random()*e)];r=o.children(),e=r.length,r[Math.floor(Math.random()*e)].addChild(),r[Math.floor(Math.random()*e)].addChild()}}}function FBT(t,r,e){function o(t){return l.circle(t.x,t.y,30).attr({fill:"#057cb8","stroke-width":0}).hover(p.circle.grow,p.circle.shrink).toBack().id}function n(t){M.push(t);for(var r=0;r<M.length;++r)for(var e=M[r],o=e.children(),n=0;n<o.length;++n)M.push(o[n])}function a(t){if(t){l.setStart(),M=[],n(t);for(var r=[],e=0,a=0;a<M.length+1;++a){var i=null;if(a<M.length&&(i=M[a],i.level()==e))r.push(i);else{var h={};for(var s in globalConfig)globalConfig.hasOwnProperty(s)&&(h[s]=globalConfig[s]);var f=d.width()-80;r.length>1?(h.offsetX=f/(r.length-1),h.startX=40):(h.offsetX=f/2,h.startX=f/2+40);for(var w=0;w<r.length;++w){var y={x:h.startX+w*h.offsetX,y:50+e*h.offsetY};if(r[w].parent()){var k=r[w].parent().DOMid,T=l.getById(k),C=T.attr("cx"),B=T.attr("cy"),F=l.path("M"+C+","+B+"L"+y.x+","+y.y).attr("stroke-width",3).hover(p.line.grow,p.line.shrink),b=l.path("M"+C+","+B+"L"+y.x+","+y.y).attr({"stroke-width":"15",stroke:"transparent"});b.casterId=F.id,b.hover(p.line.casterGrow,p.line.casterShrink)}r[w].DOMid=o(y)}r=[],i&&(e=i.level(),r.push(i))}}}for(var x=0;x<M.length;++x)l.getById(M[x].DOMid).toFront();origH=g=d.height(),origW=u=d.width(),v=m=0,l.setViewBox(v,m,u,g),c=l.setFinish()}var i=r?r:new Tree,h={zoomFactor:1.1,nodeRadius:30,nodeColor:"#057cb8",nodeGlowColor:"#FF8C00"},d=t?t:document.body,l=new Raphael(d);d=$(d);var s=h;if(e)for(var f in e)f in s&&(s[f]=e[f]);s.origH=d.height(),s.origW=d.width();var c,g,u,v,m,p={circle:{grow:function(){this.animate({r:Math.floor(1.33*s.nodeRadius)},500,"elastic").attr({fill:"darkorange"})},shrink:function(){this.animate({r:s.nodeRadius},500,"elastic").attr({fill:"#057cb8"})}},line:{casterGrow:function(){l.getById(this.casterId).attr({"stroke-width":4,stroke:"darkorange"})},casterShrink:function(){l.getById(this.casterId).animate({stroke:"#000"},100).attr("stroke-width",3)}}};l.setStart();var w={x:Math.floor(s.origW/2),y:50};globalConfig={rootX:w.x,rootY:w.y,offsetY:150};var M=[];a(i.root);var y,k,T,C,B=0,F=0,b=0,x=0,X=0;window.addWheelListener(document.getElementById("fbt-container"),function(t){if(!B){t.preventDefault();var r=T/origW,e=C/origH,o=T/origW*u+v,n=C/origH*g+m;t.deltaY<0?(u=Math.round(u/s.zoomFactor),g=Math.round(g/s.zoomFactor)):(u=Math.round(u*s.zoomFactor),g=Math.round(g*s.zoomFactor)),v=Math.round(o-r*u),m=Math.round(n-e*g),l.setViewBox(v,m,Math.round(u),Math.round(g))}}),d.mousedown(function(t){1==t.which&&(B=1,y=t.pageX,k=t.pageY)}),d.mousemove(function(t){if(T=t.pageX-Math.round(d.offset().left),C=t.pageY-Math.round(d.offset().top),B){var r=t.pageX,e=t.pageY,o=u/origW;F=(r-y)*o,0!==x&&(F+=x),b=(e-k)*o,0!==X&&(b+=X),c.transform("T"+F+","+b)}}),d.mouseup(function(){x=F,X=b,B=0}),d.dblclick(function(t){t.preventDefault(),t.stopPropagation(),c.transform("T0,0"),v=m=F=b=x=X=0,l.setViewBox(0,0,origW,origH),g=origH,u=origW}),$(window).resize(function(){l.clear(),l.setStart(),a(i.root),c=l.setFinish(),c.transform("T"+F+","+b)})}function Node(){this.name="",this.type="normal";var t=null,r=[],e=0;if(this.children=function(){return r},this.parent=function(){return t},this.level=function(){return e},arguments[0]){var o=arguments[0];"name"in o&&(this.name=o.name),"type"in o&&(this.type=o.type),"children"in o&&(r=o.children()),"parent"in o&&(t=o.parent),"level"in o&&(e=o.level)}this.addChild=function(t){t?(t.parent=this,t.level=this.level()+1):t={parent:this,level:this.level()+1},r.push(new Node(t))}}function Tree(){this.root=new Node({type:"root"})}var randTree=new Tree;generate(),FBT(document.getElementById("fbt-container"),randTree);